steps:

- name: 'golang'
  args: ['go','get', 'github.com/gruntwork-io/terratest/modules/gcp']

- name: 'golang'
  args: ['go', 'get', 'github.com/gruntwork-io/terratest/modules/terraform']

- name: 'golang'
  args: ['go', 'mod', 'init', 'terraunittest']
  dir: 'tests/unit/${_MOD_NAME}'

- name: 'golang'
  args: ['go', 'mod', 'tidy']
  dir: 'tests/unit/${_MOD_NAME}'

- name: 'binxio/terratest-runner-gcp'
  args: ['go', 'test', '-v', './...', '-timeout', '120m', '-p', '1']
  dir: 'tests/unit/${_MOD_NAME}'
  env: ['GCLOUD_PROJECT=kc-gke-wp']

timeout: 7200s